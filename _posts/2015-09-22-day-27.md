---
layout: post
title: "Day 27"
description: ""
category:
tags: []
---
{% include JB/setup %}
**TUESDAY**

- ~~15 minutes bike~~
- ~~mowed yard~~
- ~~cleared out garage~~

I'm working on duplicating the work on Simultaneous Tracking and Calibration(STAC) done by the Motion Control Lab at the UW. So far it is all moving along quite well. My biggest challenges up to this point have been just reading up on Maximum Likelihood Estimation (MLE) and the Levenberg-Marquardt Algorithm (LMA) as I prepare to implement them for the STAC algorithm.

The pseudo-code for my initial implementation of STAC looks like this.
```matlab
% Load model
mj('load', 'MPL.xml');
q = mj('get', 'qpos');

% Create sensors
theta_true = 4.0 * random(nJoints, 2 * nSensors);
% Simple function that does matrix multiplication
% to generate sensor reading, also will add in noise:
% v_j = theta_bias_j + theta_gain_j * q_j + eta;
v = read_sensors(theta_true, q);

% Generate trajectories with random walk, linspace, etc..
params = ... ; % a bunch of parameters
[Q_true, V_sensors] = get_trajectories(params);


% Now simultaneously calibrate and track in an alternating fashion
[nSensors, nTime] = size(V_sensors);

% Initialize q_est and theta_est
q_est = random(size(q));
theta_est = random(size(theta_true));
s = 0 % short for switch

% Use maximum likelihood estimate alternating
% between q-phase (Tracking) and p-phase (Calibration)
for k = 1:nTime
  if s == 0
    % estimate joint angles using theta_est
    q_est = mle(V_sensor(:, k), theta_est)
    s = 1;
  else
    % estimate sensor parameters using q_est
    theta_est = mle(V_sensors(:,k), q_est)
    s = 0;
  end
end

% We could add more things and of course it is going to look
% completely different for the production version, but this
% is the general idea. For each data point or alternating mini-batch,
% we swap between tracking and calibration because the resulting problems
% are conditionally independent.

```
